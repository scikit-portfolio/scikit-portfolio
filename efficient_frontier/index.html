<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://scikit-portfolio.github.io/efficient_frontier/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Classical Mean-Variance - scikit-portfolio</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="//use.fontawesome.com/releases/v5.8.1/css/all.css" rel="stylesheet" />
        <link href="//use.fontawesome.com/releases/v5.8.1/css/v4-shims.css" rel="stylesheet" />
        <link href="../css/mkapi-common.css" rel="stylesheet" />
        <link href="../css/mkapi-readthedocs.css" rel="stylesheet" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Classical Mean-Variance";
        var mkdocs_page_input_path = "efficient_frontier.md";
        var mkdocs_page_url = "/efficient_frontier/";
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="..">
          <img src="../imgs/scikit_portfolio.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Basics</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../installation/">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../getting_started/">Getting started</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../portfolio_optimization_theory/">Portfolio optimization theory</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Algorithms</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Efficient frontier</a>
    <ul class="current">
                <li class="toctree-l2 current"><a class="reference internal current" href="./">Classical Mean-Variance</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#minimum-volatility">Minimum volatility üìñ</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#example-usage">Example usage</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#efficient-return-on-mean-variance-frontier">Efficient return on mean variance frontier üìñ</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#example-usage_1">Example usage</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#efficient-risk-on-mean-variance-frontier">Efficient risk on mean variance frontier üìñ</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#example-usage_2">Example usage</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#plotting-the-efficient-frontier">Plotting the efficient frontier</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#example">Example</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../efficient_semivariance/">Mean-Semivariance</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../efficient_cvar/">Conditional Value At Risk</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../efficient_cdar/">Conditional Drawdown At Risk</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../efficient_omega/">Omega ratio</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../efficient_mad/">Mean Absolute Deviation (MAD)</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Information theory</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../efficient_repo/">REPO</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ensemble/">Ensemble methods</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../miscellaneous/">Miscellaneous</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Risk and returns</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../returns/">Returns estimators</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../risk/">Risk estimators</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Model selection</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../metrics/">Metrics and scorers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../splitters/">Cross validation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../hyperparameters/">Hyperparameters optimization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../backtesting/">Backtesting</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Developing new methods</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../portfolio_estimator/">Estimators</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../docker/">Docker</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../datasets/">Datasets</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">API</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../efficient_frontier_api/">Mean Variance frontier</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../efficient_semivariance_api/">Mean semivariance frontier</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../efficient_cvar_api/">Conditional Value At Risk (CVaR)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../efficient_cdar_api/">Conditional Drawdown At Risk (CDaR)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../efficient_omega_api/">Omega Ratio</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../efficient_mad_api/">Mean Absolute Deviation (MAD)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../risk_api/">Risk estimators</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../returns_api/">Returns estimators</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">scikit-portfolio</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Algorithms &raquo;</li>
          <li>Efficient frontier &raquo;</li><li>Classical Mean-Variance</li>
    <li class="wy-breadcrumbs-aside">
        <a href="https://github.com/CarloNicolini/scikit-portfolio/edit/master/docs/efficient_frontier.md"
          class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="classical-markowitz-mean-variance-optimization">Classical Markowitz Mean-Variance optimization<a class="headerlink" href="#classical-markowitz-mean-variance-optimization" title="Permanent link">&para;</a></h1>
<p>In the classical mean-variance optimization one seeks a combination of asset weights that optimize either the volatility
measured by standard deviation of asset returns, given a target return, or maximizes the return given an upper bound 
on the volatility.
Maximum <a href="../metrics/#sharpe-ratio-sharpe_ratio">Sharpe ratio</a> portfolio for example, is given by the selection of weights maximizing the ratio of expected returns and <a href="../metrics/#portfolio-volatility-portfolio_vol">volatility</a> given a risk-free rate, typically implied by bonds, which are carrying no risk.</p>
<p>The <strong>efficient frontier</strong> is the set of optimal portfolios that provides the highest expected return for a given level of risk, or the lowest risk for a given level of expected return. Portfolios that do not correspond with the efficient frontier are <strong>sub-optimal</strong> by definition.
The efficient frontier is commonly depicted as a hyperbola, with the portfolio return on the vertical axis and risk or volatility on the horizontal axis, like in the following figure:</p>
<p><img alt="efficient frontier" src="../imgs/efficient_frontier.svg" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the picture above, the maximum return portfolio <strong>always</strong> corresponds to the portfolio weighted <strong>100% on the riskiest asset</strong>, that is also
coincident with maximum volatility (üîµÔ∏è blue dot in the upper right part of the efficient frontier plot).
The <strong>minimum risk</strong> portfolio instead corresponds to the üü¢ green dot at the left spectrum of the lowest risk and lowest return. All other black dots ‚ö´Ô∏è are portfolios consisting of a single asset.</p>
</div>
<hr>

<h2 id="minimum-volatility">Minimum volatility <a href="../efficient_frontier_api/#minimum-volatility">üìñ</a><a class="headerlink" href="#minimum-volatility" title="Permanent link">&para;</a></h2>
<p>Calculates the portfolio with the least volatility over the efficient frontier, namely the green dot üü¢ in the Markowitz mean-variance efficient frontier. This portfolio algorithm requires no estimates on expected returns, hence its estimation is typically considered more robust than other points along the frontier. 
The optimal weights are determined by the following portfolio optimization problem, where portfolio volatility is minimized:</p>
<div class="arithmatex">\[\begin{split}\begin{equation*}
\begin{aligned}
&amp; \underset{\mathbf{w} \in [0,1]^N}{\text{minimize}} &amp; &amp; \mathbf{w}^T \boldsymbol{\Sigma} \mathbf{w} \\
&amp;&amp;&amp; \mathbf{w}^T \mathbf{1} = 1\\
&amp;&amp;&amp; w_{\min} \leq w_i \leq w_{\max}\\
\end{aligned}
\end{equation*}\end{split}\]</div>
<p>Additional constraints can be added manually by specifiying with the <code>add_constraint</code> method</p>
<h3 id="example-usage">Example usage<a class="headerlink" href="#example-usage" title="Permanent link">&para;</a></h3>
<p>The basic usage of the class is very easy, in one line you fit the <code>MinimumVolatility</code> portfolio and get the weights</p>
<pre><code class="language-python">from skportfolio.frontier import MinimumVolatility
from skportfolio.datasets import load_tech_stock_prices

prices = load_tech_stock_prices()
returns = prices.pct_change().dropna()
# fit portfolio directly on prices
MinimumVolatility().fit(prices).weights_
# or fit portfolio on returns, but apply weights on prices
MinimumVolatility(returns_data=True).fit(returns).predict(prices)
</code></pre>
<p>Altenatively, one can modify the risk estimator. Rather than the <code>SampleCovariance</code>, other covariance estimators can be chosen, such as the weighted exponential moving average of covariance <code>CovarianceExp</code> (see the <a href="../returns/">returns and risk estimators section</a>:</p>
<pre><code class="language-python">from skportfolio import CovarianceExp
from skportfolio.frontier import MinimumVolatility
from skportfolio.datasets import load_tech_stock_prices
import matplotlib.pyplot as plt
import pandas as pd

prices = load_tech_stock_prices()
# compare the two allocations between sample covariance and exponentially moving weighted average covariance with a span of 180 days
w_sample_cov = MinimumVolatility(frequency=252).fit(prices).weights_.rename('Min Vol - sample covariance')
w_cov_exp = MinimumVolatility(risk_estimator=CovarianceExp(frequency=252, span=180), frequency=252).fit(load_tech_stock_prices()).weights_.rename('MinVol-CovarianceExp')
pd.concat([w_sample_cov, w_cov_exp], axis=1).plot.bar()
plt.grid(True)
</code></pre>
<p><img alt="sample_cov_vs_cov_exp" src="../imgs/minvol_sample_vs_covexp.svg" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this example, the optimization problem is the same, but one can observe some differences in terms of allocation.
This is mainly due to the different covariance estimator.
The best covariance estimator must always be chosen by backtesting on data and looking at the best cross-validation score.
For more information, look at the <a href="../hyperparameters/">backtesting</a> section.</p>
</div>
<hr>

<h2 id="efficient-return-on-mean-variance-frontier">Efficient return on mean variance frontier <a href="../efficient_frontier_api/#meanvarianceefficientreturn">üìñ</a><a class="headerlink" href="#efficient-return-on-mean-variance-frontier" title="Permanent link">&para;</a></h2>
<p>Calculates the portfolio over the efficient frontier given target portfolio return <span class="arithmatex">\(\rho_P^\star\)</span>.
It explicitly solves the following optimization problem, where portfolio volatility is minimized given a lower bound on
portfolio returns <span class="arithmatex">\(\mathbf{w}^T \boldsymbol \mu\)</span>:</p>
<div class="arithmatex">\[\begin{split}\begin{equation*}
\begin{aligned}
&amp; \underset{\mathbf{w}}{\text{minimize}} &amp; &amp; \mathbf{w}^T \boldsymbol \Sigma \mathbf{w} \\
&amp; \text{subject to} &amp; &amp; \mathbf{w}^T \boldsymbol \mu \geq \rho_P^\star \\
&amp;&amp;&amp; \mathbf{w}^T \mathbf{1} = 1\\
&amp;&amp;&amp; w_{\min} \leq w_i \leq w_{\max}\\
\end{aligned}
\end{equation*}\end{split}\]</div>
<h3 id="example-usage_1">Example usage<a class="headerlink" href="#example-usage_1" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">from skportfolio.frontier import MeanVarianceEfficientReturn
from skportfolio.datasets import load_tech_stock_prices

prices = load_tech_stock_prices()
returns = prices.pct_change().dropna()
# fit portfolio directly on prices, with target_return set in initialization
MeanVarianceEfficientReturn(target_return=0.05).fit(prices).weights_
# or fit portfolio on returns, changing target return and applying weights on prices
MeanVarianceEfficientReturn(returns_data=True).set_target_return(target_return=0.05).fit(returns).predict(prices)
</code></pre>
<hr>

<h2 id="efficient-risk-on-mean-variance-frontier">Efficient risk on mean variance frontier <a href="../efficient_frontier_api/#meanvarianceefficientrisk">üìñ</a><a class="headerlink" href="#efficient-risk-on-mean-variance-frontier" title="Permanent link">&para;</a></h2>
<p>Calculates the portfolio over the efficient frontier given target portfolio volatility <span class="arithmatex">\(\sigma_P^\star\)</span>.
It explicitly solves the following optimization problem, where portfolio return is maximized given an upper limit 
to portfolio volatility <span class="arithmatex">\(\sigma^\star_P\)</span>.</p>
<div class="arithmatex">\[\begin{split}\begin{equation*}
\begin{aligned}
&amp; \underset{\mathbf{w}}{\text{maximize}} &amp; &amp; \mathbf{w}^T \boldsymbol \mu \\
&amp; \text{subject to} &amp; &amp;  \mathbf{w}^T \boldsymbol{\Sigma} \mathbf{w}  \leq \sigma^{2\star}_P \\
&amp;&amp;&amp; \mathbf{w}^T \mathbf{1} = 1\\
&amp;&amp;&amp; w_{\min} \leq w_i \leq w_{\max}\\
\end{aligned}
\end{equation*}\end{split}\]</div>
<h3 id="example-usage_2">Example usage<a class="headerlink" href="#example-usage_2" title="Permanent link">&para;</a></h3>
<pre><code class="language-python">from skportfolio.frontier import MeanVarianceEfficientRisk
from skportfolio.datasets import load_tech_stock_prices

prices = load_tech_stock_prices()
returns = prices.pct_change().dropna()
# fit portfolio directly on prices, with target_return set in initialization
MeanVarianceEfficientRisk(target_return=0.05).fit(prices).weights_
# or fit portfolio on returns, changing target return and applying weights on prices
MeanVarianceEfficientRisk(returns_data=True).set_target_risk(target_return=0.05).fit(returns).predict(prices)
</code></pre>
<h2 id="plotting-the-efficient-frontier">Plotting the efficient frontier<a class="headerlink" href="#plotting-the-efficient-frontier" title="Permanent link">&para;</a></h2>
<p>You can simply create the specific portfolio object and call '.plot_frontier' specifying the number of points along the frontier to be computed.</p>
<p>All the classes inheriting from <code>_BaseEfficientFrontierPortfolioEstimator</code> have the possibility to explore the efficient frontier, given <code>prices</code> or <code>returns</code> data.
Currently, these are the portfolio estimators supporting the <code>.estimate_frontier</code> and <code>.plot_frontier</code></p>
<ul>
<li><a href="./">Classic Mean-Variance</a></li>
<li><a href="../efficient_semivariance/">Mean-Semivariance</a></li>
<li><a href="../efficient_cvar/">CVar</a></li>
<li><a href="../efficient_cdar/">CDar</a></li>
<li><a href="../efficient_mad/">Mean Absolute Deviation</a></li>
<li><a href="../efficient_omega/">Omega ratio</a></li>
</ul>
<h3 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h3>
<p>Plotting the efficient frontier is very easy. The <code>plot_frontier</code> method accepts a large number of aesthetic arguments to make the visualization more readable and content-rich.
Look at the method documentation for further information.</p>
<pre><code class="language-python">from skportfolio import MinimumVolatility, MeanVarianceEfficientRisk
from skportfolio.datasets import load_tech_stock_prices
prices = load_tech_stock_prices()

ax = MinimumVolatility().fit(prices).plot_frontier(prices, num_portfolios=20)
ax = (
    MeanVarianceEfficientRisk()
        .set_target_risk(0.5)
        .fit(prices)
        .plot_frontier(
        prices,
        num_portfolios=20,
        show_assets=True,
        show_only_portfolio=True,
        ax=ax
    )
)
</code></pre>
<p>The result is the following:</p>
<p><img alt="efficient_frontier_multiple_portfolios" src="../imgs/efficient_frontier_multiple_assets.svg" /></p>
<h1 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h1>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Markowitz H., "Portfolio selection", J. Fin, Vol. 7, No. 1. (1952), pp. 77-91 <a href="https://www.math.hkust.edu.hk/~maykwok/courses/ma362/07F/markowitz_JF.pdf">url</a>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>Markowitz itself noted that the average portfolio return and standard deviation were not good measures. Cited from its 1952 paper: <em>"One suggestion as to tentative <span class="arithmatex">\(\mu_i\)</span>, <span class="arithmatex">\(\sigma_{ij}\)</span> to use the observed <span class="arithmatex">\(\mu_i\)</span>, <span class="arithmatex">\(\sigma_{ii}\)</span> for some period of the past. I believe that better methods, which take
into account more information, can be found."</em>&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../portfolio_optimization_theory/" class="btn btn-neutral float-left" title="Portfolio optimization theory"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../efficient_semivariance/" class="btn btn-neutral float-right" title="Mean-Semivariance">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/CarloNicolini/scikit-portfolio" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../portfolio_optimization_theory/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../efficient_semivariance/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../js/mkapi.js" defer></script>
      <script src="../javascripts/config.js" defer></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" defer></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
